(()=>{"use strict";var e={n:o=>{var t=o&&o.__esModule?()=>o.default:()=>o;return e.d(t,{a:t}),t},d:(o,t)=>{for(var r in t)e.o(t,r)&&!e.o(o,r)&&Object.defineProperty(o,r,{enumerable:!0,get:t[r]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};const o=window.wp.blocks,t=window.wp.components,r=window.wp.serverSideRender;var n=e.n(r);const s=window.wp.blockEditor,a=window.wp.element,l=window.wp.data,p=window.ReactJSXRuntime;(0,o.registerBlockType)("fmwp-block/fmwp-topic",{edit:function(e){const o=(0,s.useBlockProps)(),{attributes:r,setAttributes:i}=e,{show_forum:w,show_header:c,order:d,id:u}=r,_=(0,l.useSelect)((e=>{const{getEntityRecords:o}=e("core");return o("postType","fmwp_topic",{per_page:100})||[]}),[]),f=((0,a.useMemo)((()=>{let e="[fmwp_topic";return e+=` show_forum="${w?1:0}"`,e+=` show_header="${c?1:0}"`,e+=` order="${d}"`,u&&(e+=` id="${u}"`),e+="]",e}),[w,c,d,u]),(0,a.useCallback)((e=>i({show_forum:e})),[i])),m=(0,a.useCallback)((e=>i({show_header:e})),[i]),h=(0,a.useCallback)((e=>i({order:e})),[i]),b=(0,a.useCallback)((e=>i({id:e})),[i]);return(0,p.jsxs)("div",{...o,children:[(0,p.jsx)(n(),{block:"fmwp-block/fmwp-topic",attributes:r}),(0,p.jsx)(s.InspectorControls,{children:(0,p.jsxs)(t.PanelBody,{title:wp.i18n.__("Topic Settings","forumwp"),children:[(0,p.jsx)(t.ToggleControl,{label:wp.i18n.__("Show Forum?","forumwp"),checked:w,onChange:f}),(0,p.jsx)(t.ToggleControl,{label:wp.i18n.__("Show Header?","forumwp"),checked:c,onChange:m}),(0,p.jsx)(t.SelectControl,{label:wp.i18n.__("Order","forumwp"),value:d,options:[{value:"date_desc",label:wp.i18n.__("Newest to Oldest","forumwp")},{value:"date_asc",label:wp.i18n.__("Oldest to Newest","forumwp")},{value:"likes_desc",label:wp.i18n.__("Most likes (Likes module)","forumwp")},{value:"votes_desc",label:wp.i18n.__("Most votes (Votes module)","forumwp")}],onChange:h}),(0,p.jsx)(t.SelectControl,{label:wp.i18n.__("Topic ID","forumwp"),value:u,options:[{label:wp.i18n.__("Select a Topic","forumwp"),value:""},..._.map((e=>({label:e.title.rendered,value:e.id})))],onChange:b})]})})]})},save:()=>null}),jQuery(window).on("load",(function(){new MutationObserver((e=>{e.forEach((e=>{jQuery(e.addedNodes).find(".fmwp-forum-wrapper").each((function(){jQuery(".fmwp-forum-wrapper").each((function(){fmwp_get_topics_for_forum(jQuery(this).find(".fmwp-topics-wrapper"),{page:1,order:jQuery(this).find(".fmwp-topics-wrapper").data("order")})}))}))}))})).observe(document,{attributes:!1,childList:!0,characterData:!1,subtree:!0})})),wp.hooks.addAction("fmwp_topics_load_finish","fmwp_topics_load_finish_block",(()=>{const e=document.querySelector(".fmwp-topics-wrapper");e&&e.addEventListener("click",(o=>{o.target!==e&&(o.preventDefault(),o.stopPropagation())}))}))})();