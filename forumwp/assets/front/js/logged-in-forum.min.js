jQuery(document).ready(function(n){fmwp_init_tags_suggest(n("#fmwp-topic-tags")),n(document.body).on("click",".fmwp-edit-topic",function(i){var t,e,p;i.preventDefault(),fmwp_is_busy("individual_forum")||(t=n("#fmwp-topic-popup-wrapper"),e=n("#fmwptopiccontent"),p=n(this).closest(".fmwp-topic-row").data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_get_topic",{data:{topic_id:p,nonce:fmwp_front_data.nonce},success:function(i){var o;fmwp_init_tags_suggest(n('input[name="fmwp-topic[tags]"]')),t.find('input[name="fmwp-action"]').val("edit-topic"),t.find('input[name="fmwp-topic[topic_id]"]').val(p),t.find('input[name="fmwp-topic[title]"]').val(i.title),t.find('input[name="fmwp-topic[tags]"]').val(i.tags),wp.hooks.doAction("fmwp_on_open_edit_topic_popup",i,t),"undefined"!=typeof tinymce&&((o=tinymce.get("fmwptopiccontent"))&&o instanceof tinymce.Editor&&o.setContent(i.orig_content,{format:"html"}),tinymce.execCommand("mceFocus",!1,"fmwptopiccontent")),e.val(i.orig_content).trigger("keyup"),n("#fmwptopiccontent-preview").html(i.content),t.trigger("fmwp_topic_popup_loaded",{data:i}),t.find("input, #wp-fmwptopiccontent-wrap").removeClass("fmwp-error-field").removeAttr("title"),t.is(":visible")?(e.focus(),fmwp_resize_popup(),fmwp_autocomplete_mentions(),n(document).trigger("fmwp_edit_topic")):t.show(1,function(){e.focus(),fmwp_resize_popup(),fmwp_autocomplete_mentions(),n(document).trigger("fmwp_edit_topic")}),t.data("fmwp-target","forum-page"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-create-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(i=(i=n(this).data("fmwp_forum_id"))||n(this).parents(".fmwp-forum-wrapper").find(".fmwp-forum-head").data("fmwp_forum_id"),o=n("#fmwp-topic-popup-wrapper"),t=n("#fmwptopiccontent"),o.is(":visible")?t.focus():(o.find('input[name="fmwp-action"]').val("create-topic"),o.find('input[name="fmwp-topic[topic_id]"]').val(""),o.find('input[name="fmwp-topic[forum_id]"]').val(i),t.val("").trigger("keyup"),o.find("input, #wp-fmwptopiccontent-wrap").removeClass("fmwp-error-field").removeAttr("title"),o.show(1,function(){t.focus(),fmwp_resize_popup(),fmwp_autocomplete_mentions(),n(document).trigger("fmwp_create_topic")})))}),n(document.body).on("click",".fmwp-report-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_report_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.addClass("fmwp-topic-reported"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-unreport-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_unreport_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.removeClass("fmwp-topic-reported"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-clear-reports-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_clear_reports_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.removeClass("fmwp-topic-reported"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-mark-spam-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_mark_spam_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.data("spam",!0).addClass("fmwp-topic-spam"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-restore-spam-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_restore_spam_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.data("spam",!1).removeClass("fmwp-topic-spam"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-lock-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_lock_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.data("locked",!0).addClass("fmwp-topic-locked"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-unlock-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_unlock_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.data("locked",!1).removeClass("fmwp-topic-locked"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-pin-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_pin_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.data("pinned",!0).addClass("fmwp-topic-pinned"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-unpin-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_unpin_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.data("pinned",!1).removeClass("fmwp-topic-pinned"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-trash-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_trash_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.addClass("fmwp-topic-trashed").removeClass("fmwp-topic-pending").data("trashed",!0),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-restore-topic",function(i){var o,t;i.preventDefault(),fmwp_is_busy("individual_forum")||(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_restore_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){fmwp_rebuild_dropdown(i,o),t.removeClass("fmwp-topic-trashed").data("trashed",!1),"fmwp_locked"===i.status?t.addClass("fmwp-topic-locked"):"pending"===i.status&&t.addClass("fmwp-topic-pending"),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))}),n(document.body).on("click",".fmwp-remove-topic",function(){var o,t,i;fmwp_is_busy("individual_forum")||confirm(wp.i18n.__("Are you sure to delete permanently this topic. This operation can not be canceled.","forumwp"))&&(o=n(this),i=(t=n(this).closest(".fmwp-topic-row")).data("topic_id"),fmwp_set_busy("individual_forum",!0),wp.ajax.send("fmwp_delete_topic",{data:{topic_id:i,nonce:fmwp_front_data.nonce},success:function(i){0===parseInt(i.statistic.topics)&&o.parents(".fmwp-topics-wrapper").html(fmwp_no_topics_template),t.remove(),fmwp_set_busy("individual_forum",!1)},error:function(i){console.log(i),n(this).fmwp_notice({message:i,type:"error"}),fmwp_set_busy("individual_forum",!1)}}))})});