var fmwp_profile={topics:{page:2,loading:!1},replies:{page:2,loading:!1}};function fmwp_profile_show_loader(e){e.find("> .fmwp-ajax-loading").show()}function fmwp_profile_hide_loader(e){e.find(" > .fmwp-ajax-loading").hide()}function fmwp_profile_replies(t,p){t.find(".fmwp-ajax-loading").show(),fmwp_profile.replies.loading=!0,1===p.page&&t.find(".fmwp-replies-wrapper").html(""),wp.ajax.send("fmwp_profile_replies",{data:{user_id:p.user_id,page:p.page,nonce:fmwp_front_data.nonce},success:function(e){t.find(".fmwp-ajax-loading").hide(),t.find(".fmwp-load-more").remove(),e.length?(e=wp.template("fmwp-replies-list")({replies:e}),1===p.page?t.find(".fmwp-replies-wrapper").html(e+'<span class="fmwp-load-more"></span>'):t.find(".fmwp-replies-wrapper").append(e+'<span class="fmwp-load-more"></span>'),fmwp_embed_resize_async(),fmwp_profile.replies.page=parseInt(p.page)+1):1===p.page&&t.html('<span class="fmwp-profile-no-replies">'+wp.i18n.__("No replies","forumwp")+"</span>"),fmwp_profile.replies.loading=!1,fmwp_responsive(),wp.hooks.doAction("fmwp_profile_load_finish")},error:function(e){console.log(e),t.find(".fmwp-ajax-loading").hide(),jQuery(this).fmwp_notice({message:e,type:"error"}),fmwp_profile.replies.loading=!1}})}function fmwp_profile_topics(t,p){fmwp_profile.topics.loading=!0,t.find(".fmwp-ajax-loading").show(),1===p.page&&t.find(".fmwp-topics-wrapper").html(""),wp.ajax.send("fmwp_profile_topics",{data:{user_id:p.user_id,page:p.page,nonce:fmwp_front_data.nonce},success:function(e){t.find(".fmwp-ajax-loading").hide(),t.find(".fmwp-load-more").remove(),e.length?(e=wp.template("fmwp-topics-list")({topics:e}),1===p.page?t.find(".fmwp-topics-wrapper").html(e+'<span class="fmwp-load-more"></span>'):t.find(".fmwp-topics-wrapper").append(e+'<span class="fmwp-load-more"></span>'),fmwp_embed_resize_async(),fmwp_profile.topics.page=parseInt(p.page)+1):1===p.page&&t.find(".fmwp-topics-wrapper").html('<span class="fmwp-profile-no-topics">'+wp.i18n.__("No topics","forumwp")+"</span>"),fmwp_profile.topics.loading=!1,fmwp_responsive(),wp.hooks.doAction("fmwp_profile_load_finish")},error:function(e){console.log(e),t.find(".fmwp-ajax-loading").hide(),jQuery(this).fmwp_notice({message:e,type:"error"}),fmwp_profile.topics.loading=!1}})}jQuery(document).ready(function(n){fmwp_profile=wp.hooks.applyFilters("fmwp_profile_tabs",fmwp_profile),fmwp_embed_containers.push(".fmwp-reply-content"),n(window).on("load",function(){n(".fmwp-profile-wrapper").each(function(){var e,t=n(this).find(".fmwp-profile-mobile .fmwp-profile-menu > .fmwp-active-tab"),p=t.find("a").data("tab"),t=(t.siblings(".fmwp-profile-menu-indicator").animate({left:t.position().left,width:t.outerWidth()+"px"}),t.outerWidth()+t.offset().left>=t.parents("ul").outerWidth()&&(e=t.outerWidth()-(t.parents("nav").outerWidth()-t.offset().left-t.parents("nav").offset().left)+t.parents("nav").scrollLeft(),t.parents("nav").animate({scrollLeft:e})),n(this).find('.fmwp-profile-scroll-content .fmwp-profile-tab-content[data-tab="'+p+'"]'),n(this).find('.fmwp-profile-scroll-content .fmwp-profile-tab-content[data-tab="'+p+'"]').offset().left-n(this).find(".fmwp-profile-scroll-content").offset().left+n(this).find(".fmwp-profile-scroll-content").scrollLeft());n(".fmwp-profile-scroll-content").scrollLeft(t)})});var e=n(".fmwp-profile-menu").find("li.fmwp-active-tab > a").data("tab"),t=n('.fmwp-profile-tab-content[data-tab="'+e+'"]').find("li.fmwp-active-tab > a").data("tab"),p=n(".fmwp-profile-wrapper").data("user_id");"topics"===e?fmwp_profile_topics(n(".fmwp-profile-"+e+"-content"),{page:1,user_id:p}):"replies"===e?fmwp_profile_replies(n(".fmwp-profile-"+e+"-content"),{page:1,user_id:p}):wp.hooks.doAction("fmwp_user_profile_tab_loading",e,t,p),n(window).on("scroll",function(){var e,t={allow:!0,reallow:function(){t.allow=!0},delay:400};n(".fmwp-profile-topics-content:visible").length?!fmwp_profile.topics.loading&&t.allow&&(t.allow=!1,(e=n(".fmwp-profile-topics-content .fmwp-load-more")).length)&&(setTimeout(t.reallow,t.delay),e.offset().top-n(window).scrollTop()<1e3)&&fmwp_profile_topics(n(".fmwp-profile-topics-content"),{page:fmwp_profile.topics.page,user_id:e.parents(".fmwp-profile-wrapper").data("user_id")}):n(".fmwp-profile-replies-content:visible").length?!fmwp_profile.replies.loading&&t.allow&&(t.allow=!1,(e=n(".fmwp-profile-replies-content .fmwp-load-more")).length)&&(setTimeout(t.reallow,t.delay),e.offset().top-n(window).scrollTop()<1e3)&&fmwp_profile_replies(n(".fmwp-profile-replies-content"),{page:fmwp_profile.replies.page,user_id:e.parents(".fmwp-profile-wrapper").data("user_id")}):wp.hooks.doAction("fmwp_user_profile_tab_scroll",t)}),n(document.body).on("click",".fmwp-profile-load-content-link",function(e){var t,p,o;e.preventDefault(),n(this).parents("li").hasClass("fmwp-active-tab")||(window.history.pushState("string","fmwp-profile-tab",n(this).attr("href")),e=n(this).parents(".fmwp-profile-wrapper"),t=e.data("user_id"),n(this).parents(".fmwp.fmwp-ui-xs").length,n(this).parents("ul").find("li").removeClass("fmwp-active-tab"),n(this).parents("li").addClass("fmwp-active-tab"),(o=!n(this).parents(".fmwp-profile-submenu").length)?e.find(".fmwp-profile-content").attr("data-active_tab",n(this).data("tab")):n(this).parents(".fmwp-profile-tab-content").attr("data-active_subtab",n(this).data("tab")),o?n(this).data("ajax")?(p=n(this).data("tab"),(insert_to=e.find(".fmwp-profile-content")).find(".fmwp-profile-"+p+"-content").length||(fmwp_profile_show_loader(insert_to),wp.ajax.send("fmwp_profile_get_content",{data:{tab:p,user_id:t,nonce:fmwp_front_data.nonce},success:function(e){e=wp.template("fmwp-profile-"+p)(e);insert_to.append('<div class="fmwp-profile-tab-content fmwp-profile-'+p+'-content">'+e+"</div>"),insert_to.find(".fmwp-profile-"+p+"-content").show(),insert_to.find('[data-checked="checked"]').prop("checked",!0).attr("checked","checked"),fmwp_responsive(),fmwp_profile_hide_loader(insert_to),insert_to.trigger("fmwp_profile_tab_loaded",{tab:p,user_id:t})},error:function(e){console.log(e),jQuery(this).fmwp_notice({message:e,type:"error"}),fmwp_profile_hide_loader(insert_to)}}))):"topics"===n(this).data("tab")?fmwp_profile_topics(n(".fmwp-profile-"+n(this).data("tab")+"-content"),{page:1,user_id:t}):"replies"===n(this).data("tab")?fmwp_profile_replies(n(".fmwp-profile-"+n(this).data("tab")+"-content"),{page:1,user_id:t}):wp.hooks.doAction("fmwp_user_profile_not_ajax_tab_loaded",n(this).data("tab")):(p=e.find(".fmwp-profile-menu:visible .fmwp-active-tab a").data("tab"),wp.hooks.doAction("fmwp_user_profile_subtab_loaded",p,n(this).data("tab"),t)))}),n(document.body).on("click",".fmwp-profile-mobile-tab-link",function(e){var t,p,o,i,a,f;e.preventDefault(),n(this).parents("li").hasClass("fmwp-active-tab")||(window.history.pushState("string","fmwp-profile-tab",n(this).attr("href")),t=(e=n(this).parents(".fmwp-profile-wrapper")).data("user_id"),p=n(this).data("tab"),n(this).parents("ul").find("li").removeClass("fmwp-active-tab"),n(this).parents("li").addClass("fmwp-active-tab"),e.find(".fmwp-profile-content").attr("data-active_tab",n(this).data("tab")),(o=n(this).parents("li")).siblings(".fmwp-profile-menu-indicator").animate({left:o.position().left,width:o.outerWidth()+"px"}),o.outerWidth()+o.offset().left>=o.parents("ul").outerWidth()?(i=o.outerWidth()-(o.parents("nav").outerWidth()-o.offset().left-n(this).parents("nav").offset().left)+n(this).parents("nav").scrollLeft(),n(this).parents("nav").animate({scrollLeft:i})):o.offset().left<0&&(i=o.offset().left-n(this).parents("nav").offset().left+n(this).parents("nav").scrollLeft()-(o.parents("nav").outerWidth()-o.parents("nav").width()),n(this).parents("nav").animate({scrollLeft:i})),n(this).data("ajax")?(f=(a=e.find(".fmwp-profile-scroll-content")).find('.fmwp-profile-tab-content[data-tab="'+p+'"]').offset().left-n(".fmwp-profile-scroll-content").offset().left+n(".fmwp-profile-scroll-content").scrollLeft(),n(".fmwp-profile-scroll-content").animate({scrollLeft:f}),a.find(".fmwp-profile-"+p+"-content").hasClass("fmwp-profile-blank-content")&&wp.ajax.send("fmwp_profile_get_content",{data:{tab:p,user_id:t,nonce:fmwp_front_data.nonce},success:function(e){e=wp.template("fmwp-profile-"+p)(e);a.find(".fmwp-profile-"+p+"-content").removeClass("fmwp-profile-blank-content").html(e),a.find('[data-checked="checked"]').prop("checked",!0).attr("checked","checked"),fmwp_responsive(),fmwp_profile_hide_loader(a)},error:function(e){console.log(e),jQuery(this).fmwp_notice({message:e,type:"error"})}})):(f=n('.fmwp-profile-tab-content[data-tab="'+p+'"]').offset().left-n(".fmwp-profile-scroll-content").offset().left+n(".fmwp-profile-scroll-content").scrollLeft(),n(".fmwp-profile-scroll-content").animate({scrollLeft:f}),"topics"===n(this).data("tab")?fmwp_profile_topics(n(".fmwp-profile-"+n(this).data("tab")+"-content"),{page:1,user_id:t}):"replies"===n(this).data("tab")?fmwp_profile_replies(n(".fmwp-profile-"+n(this).data("tab")+"-content"),{page:1,user_id:t}):wp.hooks.doAction("fmwp_user_profile_not_ajax_tab_loaded_mobile",n(this).data("tab"))))})});